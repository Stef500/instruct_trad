{% extends "base.html" %}

{% block title %}Interface de Traduction - Mode {{ mode.title() }}{% endblock %}

{% block styles %}
<!-- Session data for JavaScript -->
<meta name="session-id" content="{{ session_id }}">
<meta name="mode" content="{{ mode }}">
{% endblock %}

{% block content %}
<div class="translation-interface">
    <div class="progress-bar">
        <div class="progress-info">
            Élément <span id="currentItem">{{ progress.current_item }}</span> sur {{ progress.total_items }}
        </div>
        <div class="progress-visual">
            <div class="progress-fill" style="width: {{ progress.percentage }}%"></div>
        </div>
    </div>
    
    <div class="translation-panels">
        <div class="panel">
            <div class="panel-header">Texte source</div>
            <div class="panel-content">
                <div class="source-text" id="sourceText">{{ current_item.source_text if current_item else '' }}</div>
            </div>
        </div>
        
        <div class="panel">
            <div class="panel-header">Traduction</div>
            <div class="panel-content">
                <textarea 
                    class="translation-input" 
                    id="translationInput"
                    {% if mode == 'manual' %}placeholder="Saisissez votre traduction..."{% endif %}
                >{% if current_item %}{% if mode == 'semi_automatic' and current_item.auto_translation %}{{ current_item.auto_translation }}{% elif current_item.target_text %}{{ current_item.target_text }}{% endif %}{% endif %}</textarea>
            </div>
        </div>
    </div>
    
    <div class="control-buttons">
        <div class="button-group">
            <button class="btn btn-secondary" id="prevBtn" onclick="navigate('previous')">
                Précédent
            </button>
            <button class="btn btn-danger" id="clearBtn" onclick="clearTranslation()">
                Effacer
            </button>
        </div>
        
        <div class="status-indicator status-saved" id="statusIndicator">
            Sauvegardé
        </div>
        
        <div class="button-group">
            <button class="btn btn-primary" id="validateBtn" onclick="validateTranslation()">
                Valider
            </button>
            <button class="btn btn-secondary" id="nextBtn" onclick="navigate('next')">
                Suivant
            </button>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Global variables for backward compatibility
    let currentSessionId = '{{ session_id }}';
    let currentMode = '{{ mode }}';
</script>
<script src="{{ url_for('static', filename='translation.js') }}"></script>
{% endblock %}